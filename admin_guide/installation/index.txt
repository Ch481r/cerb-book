Installation
------------

*If you're using Cerb5 On-Demand then you don't need to worry about
installing the software. You can skip ahead.*

While it is possible to successfully install Cerb5 on a shared hosting
account, we highly recommend that you control the server you're
installing the software on.

Downloading the files to your webserver
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

First, change directory to your website's document directory. The
directory will usually be named something like ``htdocs``, ``httpdocs``,
or ``www``, under the appropriate website.

**On Unix-based servers:**

::

    $ cd /home/vhosts/example.com/httpdocs

**On Windows-based servers:**

Use Windows Explorer to open the website's document directory.

Developers should download the project from GitHub using Git
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

If you are planning on contributing patches back to the project then you
should `fork <http://help.github.com/forking/>`_ the project on
`GitHub <http://github.com/wgm/cerb5>`_ first. This will give you your
own copy of the source code. Once that is done you should use your own
repository information in the command below. If you want to checkout the
project from our official repository use the following command:

**On Unix-based servers:**

::

    $ git clone git@github.com:wgm/cerb5.git

**On Windows-based servers:**

Use a graphical Git client, like
`TortoiseGit <http://code.google.com/p/tortoisegit/>`_.

Production sites should use Subversion
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

When deploying Cerb5 on a production server you should use Subversion.
This allows you to quickly upgrade the software to benefit from future
updates. Subversion compares your files to our files and it will only
download the changes. You'll never need to download the entire project
again after your initial installation. With Subversion you won't have to
worry about an update resetting the contents of your
``framework.config.php`` file, or erasing your other changes.

**On Unix-based servers:**

::

    $ svn checkout http://svn.github.com/wgm/cerb5.git cerb5

**On Windows-based servers:**

Use a graphical Subversion client, like
`TortoiseSVN <http://tortoisesvn.tigris.org/>`_.

The unfortunate should use the ZIP Archive
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

In the event you don't have access to Git or Subversion, you can
download a ZIP archive from the project website. This archive includes
the Subversion repository information in case you want to take advantage
of the convenience of version control in the future.

You can download the latest release using ``cURL``:

::

    $ curl -O http://www.cerberusweb.com/downloads/cerb5/cerb5-latest.zip

Or you can use ``wget``:

::

    $ wget http://www.cerberusweb.com/downloads/cerb5/cerb5-latest.zip

Setting permissions
~~~~~~~~~~~~~~~~~~~

Make sure the Cerb5 files are owned by the proper user and group on the
webserver.

There are only two locations that need write access by the webserver
during your installation:

-  ``framework.config.php``
-  ``storage/``

**On Unix-based servers:**

::

    $ cd cerb5
    $ chown -R www-data:www-data .
    $ chmod -R framework.config.php storage

Note: You will need to use your own user and group information instead
of ``www-data``.

**On Windows-based servers:**

Configure your site in IIS.

Creating the database
~~~~~~~~~~~~~~~~~~~~~

Create a new MySQL database using the console or your favorite GUI.

::

    mysql> CREATE DATABASE cerb5 CHARACTER SET utf8;
    mysql> GRANT ALL PRIVILEGES ON cerb5.*  \
            TO cerb5@localhost \
            IDENTIFIED BY 'secret_password';

Note: Substitute your own database login for ``cerb5``, and replace
``secret_password`` with something more secure.

If you don't want to use ``ALL PRIVILEGES``, the minimum required
privileges for the database user are:

-  ``SELECT``
-  ``INSERT``
-  ``UPDATE``
-  ``DELETE``
-  ``CREATE``
-  ``ALTER``
-  ``DROP``
-  ``CREATE TEMPORARY TABLES``

Running the guided installer
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Cerb5 comes with a guided installer that helps you initially configure
the system.

To start the installer, point your browser to:
``http://www.example.com/cerb5/install``

Note: You will need to replace ``www.example.com`` with your actual
domain name.

Running the server environment checker
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. figure:: /images/installation/installer_step1_checker.png
   :align: center
   :alt: The requirements checker in the guided installer.

   The requirements checker in the guided installer.

The installer will determine if your server meets the requirements for
installing Cerb5. Correct any problems before proceeding, and then click
the *"Next Step"* button.

Accepting the software license
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Click the *"I Accept"* button if you agree to the licensing terms.

Configuring the database connection
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. figure:: /images/installation/installer_step3_database.png
   :align: center
   :alt: Adding database connection details.

   Adding database connection details.

Add your database connection details:

-  **Driver:** If you have the ability to use the ``MySQLi`` driver then
   you should select it. It's newer than the standard ``MySQL`` driver.
   Otherwise, use the default.
-  **Engine:** ``MyISAM`` and ``InnoDB`` both have advantages and
   disadvantages. Your choice will impact performance and various
   processes like backups. If you are unsure about the tradeoffs, use
   ``MyISAM``. If you are familiar with ``InnoDB`` then you may
   experience better performance under high loads with that engine. This
   decision isn't permanent; you can switch database engines later.
-  **Host:** This is the hostname of your database server. If it's on
   the same machine as your webserver you can enter ``localhost`` to use
   sockets rather than TCP/IP connections (which are faster). Otherwise,
   enter a hostname or IP address.
-  **Database Name:** Enter the name of the new database you created.
-  **Username:** Enter the username from your MySQL ``GRANT PRIVILEGES``
   command.
-  **Password:** Enter the password from your MySQL ``GRANT PRIVILEGES``
   command.

Once you have entered your database details, click the *"Test Settings"*
button to verify the software can connect to your database.

If successful, the installer will create your initial database structure
from incremental patches for each plugin. This may take a few moments
because the database is created by incrementally running the updates
from each previous version; so don't worry if it doesn't look like
anything is happening right away.

Configuring general settings
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. figure:: /images/installation/installer_step6_settings.png
   :align: center
   :alt: Personalizing your helpdesk.

   Personalizing your helpdesk.

In this step you'll configure the general settings of the helpdesk.

-  **Helpdesk Title:** This is the text shown at the top of the browser,
   or on each browser tab, that makes it easy to distinguish your
   helpdesk from other web pages.
-  **Default Sender:** This is the email address that your helpdesk will
   use as the *"From:"* address on outgoing mail that can't be
   attributed to a particular group. It is very important that this
   email address delivers mail to your helpdesk. In many cases you will
   want to use an email address like *"support@example.com"*.
-  **Default Sender Name:** This is the personalized name that will
   display next to the *"From:"* address in your customers' inboxes. For
   example:

::

    From: "WebGroup Media LLC" <support@webgroupmedia.com>

Click the *Continue* button when you've entered your preferences.

Configuring outgoing mail (SMTP)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. figure:: /images/installation/installer_step7_smtp.png
   :align: center
   :alt: Configuring outgoing mail.

   Configuring outgoing mail.

Your helpdesk won't be very useful if it can't send mail to your
contacts.

-  **SMTP Server:** This is your SMTP mail server. If your mail server
   is located on the same machine as your webserver then you can enter
   *"localhost"*. Otherwise this should be a hostname or IP address that
   your webserver is authorized to relay through. This is most often a
   corporate mail server or `Google Apps <https://www.google.com/a/>`_.
-  **SMTP Port:** This is the port where your SMTP server is listening
   for mail. If you aren't sure what port to use, check with your server
   administrator. Here are some defaults:

   -  SMTP: ``25``
   -  SMTP-TLS: ``587``
   -  SMTP-SSL: ``465``
   -  If you're using Google Apps, instructions can be found at
      http://mail.google.com/support/bin/answer.py?hl=en&answer=13287.

-  **SMTP Auth User:** If your SMTP server requires authorization then
   enter your username here.
-  **SMTP Auth Password:** This is only required if your SMTP server is
   using authentication.
-  **SMTP Encryption:**

   -  TLS: Mail will be sent over a transport layer security
      (`TLS <http://en.wikipedia.org/wiki/Transport_Layer_Security>`_)
      connection.
   -  SSL: Mail will be sent over an secure socket layer
      (`SSL <http://en.wikipedia.org/wiki/SSL>`_) connection.
   -  None: Encryption is disabled.

Click the *"Test Outgoing Mail"* button to verify your settings.

Creating your account
^^^^^^^^^^^^^^^^^^^^^

.. figure:: /images/installation/installer_step8_account.png
   :align: center
   :alt: Creating your account.

   Creating your account.

Now the installer will prompt you to create an administrator account
that you will use to log in to the helpdesk. Use an email address that
you check, but not something that routes back to the helpdesk. Your
helpdesk will use this email address to contact you in the event you
lose your password, or if you configure notifications.

Choose a password and then click the *"Continue"* button.

Registering your helpdesk
^^^^^^^^^^^^^^^^^^^^^^^^^

In the final step of the installer you are given the opportunity to
introduce yourself to the Cerb5 development team in exchange for a
*free* 3 seat (simultaneous workers) license to help you get started.
There are no strings attached. This license provides full functionality
with no expiration and it is valid for the version of the helpdesk you
are installing, but it does not provide access to product updates. We
hope that you find the software useful, and we're looking forward to
growing along with you.

If you choose not to register your copy of Cerb5 then the software will
default to *"Free Mode"* which is limited to a single seat but has no
other restrictions.

Complete the short survey in exchange for your free license and then
click the *"Register"* button.

Finishing up!
^^^^^^^^^^^^^

.. figure:: /images/installation/installer_step11_finished.png
   :align: center
   :alt: The installation process is complete.

   The installation process is complete.

You're almost ready to start using your new helpdesk.

If this is a production installation, you should delete the ``install``
directory since it is no longer necessary and it provides access to some
particular sensitive information (specifically, your ``phpinfo()``
output that describes your webserver environment). If you're planning to
use language packs for localization of your helpdesk, be sure to copy
the ``install/extras/translations/*`` files to another location.

If this is a development installation, then you should leave the
``install`` directory intact since it contains many useful scripts and
examples for plugin development.

Once you're ready to log in, click the *"Take me there!"* link.
